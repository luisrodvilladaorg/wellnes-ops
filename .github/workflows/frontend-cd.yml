name: Frontend CD-v4

on:
    push:
        branches:
            - main

jobs:
    deploy-frontend:
        runs-on: self-hosted

        steps:
            # 1️⃣ Ir al directorio del proyecto en el servidor
            - name: Go to project directory
              run: |
                  cd /opt/wellness-ops

            # 2️⃣ Descargar la última imagen del frontend desde el registry
            - name: Pull latest frontend image
              run: |
                  docker compose -f docker-compose.prod.yml pull frontend

            # 3️⃣ Recrear SOLO el contenedor frontend
            # --no-deps evita reiniciar backend y nginx
            - name: Restart frontend container
              run: |
                  docker compose -f docker-compose.prod.yml up -d --no-deps frontend
